<!DOCTYPE html>
<html>
<head>
    <title>Debug Shopify OAuth</title>
</head>
<body>
    <h1>Debug Shopify OAuth Configuration</h1>
    
    <h2>Test OAuth URL (Open in same window)</h2>
    <p>This will test if the Shopify OAuth URL works when opened directly:</p>
    
    <script>
        // Get the current Replit domain
        const currentDomain = window.location.hostname;
        console.log('Current domain:', currentDomain);
        
        // Construct test OAuth URL
        const testOAuthUrl = `https://testscorestore.myshopify.com/admin/oauth/authorize?` +
            `client_id=7f12eed32ba81113c670c4c40b00bddb&` +
            `scope=read_products,write_products&` +
            `redirect_uri=${encodeURIComponent(`https://${currentDomain}/api/shopify/callback`)}&` +
            `state=test123&` +
            `grant_options[]=per-user`;
        
        console.log('Test OAuth URL:', testOAuthUrl);
        
        // Create test button
        const button = document.createElement('button');
        button.textContent = 'Test OAuth Direct Link';
        button.style.padding = '10px 20px';
        button.style.margin = '10px';
        button.style.fontSize = '16px';
        button.onclick = function() {
            console.log('Redirecting to:', testOAuthUrl);
            window.location.href = testOAuthUrl;
        };
        
        document.body.appendChild(button);
        
        // Create iframe test
        const iframe = document.createElement('iframe');
        iframe.src = testOAuthUrl;
        iframe.style.width = '100%';
        iframe.style.height = '400px';
        iframe.style.border = '1px solid #ccc';
        iframe.style.marginTop = '20px';
        
        const iframeLabel = document.createElement('h3');
        iframeLabel.textContent = 'OAuth URL in iframe (should show X-Frame-Options error):';
        
        document.body.appendChild(iframeLabel);
        document.body.appendChild(iframe);
        
        // Add information about what we're testing
        const info = document.createElement('div');
        info.innerHTML = `
            <h3>What we're testing:</h3>
            <ul>
                <li><strong>Direct redirect:</strong> Should work if Shopify app is properly configured</li>
                <li><strong>Iframe test:</strong> Should fail with X-Frame-Options error (this is expected)</li>
                <li><strong>Current redirect URI:</strong> https://${currentDomain}/api/shopify/callback</li>
            </ul>
            <h3>Common issues:</h3>
            <ul>
                <li>App not set to "Public distribution" in Shopify Partners Dashboard</li>
                <li>Redirect URI not whitelisted in app settings</li>
                <li>Development store not properly linked to app</li>
            </ul>
        `;
        info.style.backgroundColor = '#f5f5f5';
        info.style.padding = '15px';
        info.style.marginTop = '20px';
        info.style.borderRadius = '5px';
        
        document.body.appendChild(info);
    </script>
</body>
</html>